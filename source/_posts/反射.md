---
title: 反射
date: 2018-05-02 14:01:01
tags:
categories: 技术
---
##### IOC容器
###### IOC(Inverse of Control) 控制反转
对于软件来说，某一接口具体实现类的选择控制权从调用类中移除，转交给第三方决定。IOC也被叫做依赖注入，

###### 类装载器 ClassLoader
类装载器就是寻找类的字节码文件并狗仔出类在JVM内部表示的对象组件。
在java中，类装载器吧一个类装入jvm中，要经过一下步骤：
1) 装载
2) 连接
3) 初始化

<!--more-->
###### 三个转载器：
- ClassLoader 根装载器，C语言编写
- ExtClassLoader 扩展类装载器
- AppClassLoader 系统类扩展器，负责装载Classpath路径下的类包
#### 获取类装载器：
```
ClassLoader loader = Thread.currentThread().getContextClassLoader();
```

###### java中无论某个类生成多少个对象，这些对象都对应于同一个Class对象
- 反射都是再程序进行时，不是编译的时候

1) 获取类加载器
```
ClassLoader loader = Thread.currentThread().getContextClassLoader();
```
2) 获取类类型
```
Class SampleClass = loader.loadClass("com.panjianguo.service.SampleClass");
// Class SampleClass = Class.fromName("com.panjianguo.service.SampleClass");
```
下面的方法实际上是Class封装的方法，实际上都是先获取当前线程的类加载器，然后类加载器通过类的全限定名获取到类的类型对象
3) 获取类的构造函数反射类
```
Constructor declaredConstructor = SampleClass.getDeclaredConstructor();
```
4) 通过构造函数反射类创建对象
```
com.panjianguo.service.SampleClass sample = (SampleClass) declaredConstructor.newInstance();
// com.panjianguo.service.SampleClass sampleClass1 = (SampleClass) SampleClass.newInstance();
```
下面通过类名直接调用newInstance方法实际上也是调用了反射构造函数的newInstance方法，从而创建了对应类的对象
5) 获取类的方法反射类
```
Method setName = SampleClass.getMethod("setName", String.class);
```
6) 方法调用
```
setName.invoke(sampleClass, "小明");
```
